# 📝 更新日誌

所有重要的變更都會記錄在這個檔案中。

---

## [1.0.0] - 2025-10-27

### ✨ 新增功能

#### **表單系統**
- ✅ 完整的商家資料收集表單
- ✅ 支援多種店家類型（美甲、美髮、美容、紋繡、美睫等）
- ✅ 分店名稱管理
- ✅ 詳細的服務項目分類選擇
- ✅ 營業時間和公休日設定
- ✅ 社群連結收集（Facebook、Instagram、LINE、官網、Google商家）
- ✅ 商品資料管理（可新增多個商品）
- ✅ 每個商品可設定名稱、價格、描述
- ✅ 商家介紹文字欄位
- ✅ 免責聲明和隱私權政策

#### **圖片上傳**
- ⚠️ 環境圖上傳（5-10 張）- **有 Bug**
- ⚠️ 價目表上傳（1-10 張，選填）- **有 Bug**
- ⚠️ 商品圖片上傳（每個商品 1 張）- **有 Bug**
- ✅ 圖片預覽功能
- ✅ 拖放上傳支援
- ✅ 檔案大小驗證（限制 1MB）

#### **查詢系統**
- ✅ Email 查詢功能
- ✅ 顯示所有提交記錄
- ✅ 美觀的卡片式界面
- ✅ 圖片連結可點擊查看
- ✅ 支援多筆記錄顯示

#### **後端功能**
- ✅ Google Apps Script 後端
- ✅ 自動儲存到 Google Sheets
- ✅ 自動建立資料夾結構
- ✅ 資料夾命名：`店家名稱_時間戳記`
- ✅ 子資料夾分類：環境圖、價目表、商品
- ✅ 詳細的執行日誌

#### **資料管理**
- ✅ 完整的資料驗證
- ✅ 必填欄位檢查
- ✅ 格式驗證（Email、電話等）
- ✅ 自動時間戳記
- ✅ 資料正規化處理

### ⚠️ 已知問題

#### **圖片上傳功能**
- **問題描述：** 
  - 資料夾可以正常建立
  - 但圖片無法上傳到資料夾
  - 圖片連結欄位為空
  
- **影響範圍：**
  - 環境圖上傳
  - 價目表上傳
  - 商品圖片上傳
  
- **錯誤訊息：**
  ```
  Console: Base64 轉換成功
  但上傳失敗（無具體錯誤訊息）
  ```
  
- **臨時解決方案：**
  - 用戶可以手動上傳圖片到 Google Drive
  - 在表單中提供圖片連結
  
- **計劃修復：**
  - 正在調查 Base64 解碼問題
  - 考慮改用其他圖片上傳方式
  - 可能需要分批上傳

### 🔧 技術細節

#### **前端技術**
- HTML5
- CSS3
- JavaScript (ES6+)
- Fetch API
- FileReader API

#### **後端技術**
- Google Apps Script
- Google Sheets API
- Google Drive API

#### **架構**
```
Frontend (HTML)
    ↓ (HTTP POST)
Google Apps Script
    ↓
Google Sheets (資料儲存)
Google Drive (圖片儲存 - 待修復)
```

### 📊 資料結構

#### **Google Sheets 欄位（29 個）**
1. 提交時間
2. 店家類型
3. 店家名稱
4. 分店名稱
5. 聯絡人
6. 聯絡Email
7. 聯絡電話
8. 店家地址
9. 地址補充
10. 服務類別
11. 服務項目
12. 起跳金額
13. 最高金額
14. 營業日
15. 營業時間
16. 營業時間補充
17. 公休日
18. 公休日補充
19. 官方網站
20. Facebook
21. LINE
22. Instagram
23. Google商家連結
24. 連結備註
25. 商家介紹
26. 環境圖連結 (⚠️ 目前為空)
27. 價目表連結 (⚠️ 目前為空)
28. 商品資料
29. 商品圖片連結 (⚠️ 目前為空)

### 🎨 UI/UX 特色

- 響應式設計（手機、平板、電腦都適用）
- 直覺的表單流程
- 即時驗證
- 錯誤提示
- 成功提示
- 載入動畫
- 圖片預覽
- 拖放上傳
- 美觀的配色
- 清楚的說明文字

### 📦 檔案清單

```
merchant-data-system/
├── README.md                    # 專案說明
├── SETUP.md                     # 設定指南
├── CHANGELOG.md                 # 本檔案
├── google-apps-script.js        # 後端程式（689 行）
├── merchant-form.html           # 表單頁面（1651 行）
└── merchant-query.html          # 查詢頁面（621 行）
```

### 🐛 Debug 資訊

#### **圖片上傳問題 Debug 記錄**

**嘗試過的解決方案：**
1. ❌ 修改 Base64 編碼方式 - 無效
2. ❌ 增加錯誤處理 - 無法捕捉具體錯誤
3. ❌ 分批上傳 - 問題依舊
4. ❌ 改用 Logger.log - 無日誌輸出
5. ✅ 改用 console.log - 可以看到部分日誌
6. ❌ 減少圖片大小 - 問題依舊
7. ❌ 只上傳一張圖片 - 問題依舊

**觀察到的現象：**
- ✅ 資料夾創建成功
- ✅ Base64 轉換成功
- ✅ 資料有發送到 Apps Script
- ❌ 圖片沒有實際寫入 Drive
- ❌ 沒有具體的錯誤訊息

**可能的原因：**
1. Apps Script 處理 Base64 大資料有限制
2. Drive API 寫入權限問題
3. URL-encoded POST 資料太大
4. Apps Script 執行時間限制
5. 記憶體限制

**下一步計劃：**
1. 嘗試改用 Multipart/Form-Data
2. 考慮使用 Google Picker API
3. 或改成用戶手動上傳
4. 研究其他圖片上傳方案

---

## [未來計劃]

### **v1.1.0（計劃中）**
- 🔧 修復圖片上傳功能
- ✨ 新增管理員後台
- ✨ 資料匯出功能
- ✨ 進階搜尋功能
- 📊 統計分析功能

### **v1.2.0（計劃中）**
- ✨ 批次匯入功能
- ✨ 資料編輯功能
- ✨ 權限管理
- 🎨 主題自訂

### **v2.0.0（計劃中）**
- 🏗️ 重構為 React/Vue 應用
- 🔐 完整的身份驗證系統
- 📱 原生手機 App
- ☁️ 雲端資料庫整合

---

## 版本命名規則

我們使用 [語意化版本控制](https://semver.org/lang/zh-TW/)：

```
主版本號.次版本號.修訂號

主版本號：當你做了不相容的 API 修改
次版本號：當你做了向下相容的功能性新增
修訂號：當你做了向下相容的問題修正
```

---

## 貢獻指南

如果您想貢獻：

1. Fork 這個專案
2. 建立您的 feature 分支
3. 提交您的變更
4. 推送到分支
5. 開啟 Pull Request

---

**最後更新：** 2025-10-27
